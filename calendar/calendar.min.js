(function(){function e(e){E=e,L.style="display:block;top:"+(e.offsetTop+e.offsetHeight)+"px;left:"+e.offsetLeft+"px";var t=/^(?:(?!0000)[0-9]{4}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-8])|(?:0[13-9]|1[0-2])-(?:29|30)|(?:0[13578]|1[02])-31)|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)-02-29)$/g,l=e.value;g=0,t.test(l)?(document.getElementById("oneCalendarTips").innerHTML="",p=f=n(l),o(f)):(l&&(document.getElementById("oneCalendarTips").innerHTML="日期不存在"),a())}function n(e){var n=e.split("-");return{year:parseFloat(n[0]),month:parseFloat(n[1])-1,date:parseFloat(n[2])}}function a(){var e=p=s();g=0,l(e),t(e)}function t(e){f={},o(e)}function l(e){var n=e.year;h=n-n%20}function o(e){b.setAttribute("style","display: none"),g!=C&&(w.className=g>C?"out-in":"in-out",setTimeout(function(){w.className="",C=g},300)),i(e),0===g&&d(e),1===g&&m(e),2===g&&v(e)}function d(e){for(var n=r(e),a="",t=0;t<42;t++)a+=t%7==0?"<tr>"+n[t]:t%7==6?n[t]+"</tr>":n[t];var l=["日","一","二","三","四","五","六"].map(e=>`<th><div class="one-calendar-header"><span class="week-cell">${e}</span></div></th>`).join("");u(`<thead><tr>${l}</tr></thead>\n      <tbody>${a}</tbody>`)}function r(e){function n(e,n,t){var l=0,s=0;n>0?(l=n-1,s=e):(l=11,s=e-1);for(var m=[],v=c(s)?r:i,u=v[l];t>0;t--,u--)s===d.year&&d.month===l&&u===o?m.unshift(a(u,"last-month active today")):m.unshift(a(u,"last-month"));return m}function a(e,n){return`<td><div class="one-calendar-cell ${n}"><span class="date-cell">${e}</span></div></td>`}for(var{year:t,month:l,date:o}=e,d=f.year?f:s(),r=[31,29,31,30,31,30,31,31,30,31,30,31],i=[31,28,31,30,31,30,31,31,30,31,30,31],m=c(t)?r:i,v=new Date(t,l),u=v.getDay(),y=[...n(t,l,u)],p=1,h=m[l];p<=h;p++)t===d.year&&d.month===l&&p===o?y.push(a(p,"active today")):y.push(a(p,""));var g=1;for(h=42-y.length;g<=h;g++)t===d.year&&d.month-l==1&&g===o||d.year-t==1&&0===d.month&&11===l&&g===o?y.push(a(g,"next-month active today")):y.push(a(g,"next-month"));return y}function c(e){return e%4==0&&e%100!=0||e%400==0}function s(){var e=currentTime=new Date,n=e.getFullYear(),a=e.getMonth(),t=e.getDate();return{year:n,month:a,date:t}}function i(e){var{year:n,month:a,date:t}=e;h=n-n%20,$.innerHTML=n+"年"+(a+1)+"月",A.innerHTML=n+"年",H.innerHTML=h+"~"+(h+19),0===g?($.className="one-calendar-nav-time able show",A.className="one-calendar-nav-time",H.className="one-calendar-nav-time"):1===g?($.className="one-calendar-nav-time",A.className="one-calendar-nav-time able show",H.className="one-calendar-nav-time"):($.className="one-calendar-nav-time",A.className="one-calendar-nav-time",H.className="one-calendar-nav-time show")}function m(e){var n=new Array(12).fill(1),{year:a,month:t,date:l}=e,o=s(),d=n.map((e,n)=>`<td><div class="one-calendar-cell"><span class="month-cell">${n+1}月</span></div></td>`);a===o.year&&(d[t]=d[t].replace(/one-calendar-cell/g,"one-calendar-cell today"));var r="";d.forEach((e,n)=>{r+=n%4==0?"<tr>"+e:n%4==3?e+"</tr>":e}),u(r)}function v(e){for(var n=s(),a=[],t=h,l=0;l<20;l++,t++)t===n.year?a.push(`<td><div class="one-calendar-cell today"><span class="year-cell">${t}</span></div></td>`):a.push(`<td><div class="one-calendar-cell"><span class="year-cell">${t}</span></div></td>`);var o="";a.forEach((e,n)=>{o+=n%4==0?"<tr>"+e:n%4==3?e+"</tr>":e}),u(o)}function u(e){setTimeout(function(){I.innerHTML=e},150)}var y=document.querySelectorAll("input.one-dateBox");if(y.length=0)return!1;var p={},f={},h=0,g=0,C=0,E="",N=document.createElement("div");N.id="oneCalendar",N.className="one-calendar",N.innerHTML='\n    <div class="one-calendar-toolbar">\n      <span id="oneCalendarClear" class="iconfont  icon-backspace" title="清除"></span>\n      <span id="oneCalendarTips" class="tips"></span>\n      <span id="oneCalendarClose" class="iconfont  icon-close" title="关闭"></span>\n    </div>  \n    <div id="oneMoveCircle" class="one-move-circle"></div>\n    <div class="one-calendar-nav">\n      <div id="oneCalendarYearAndMonth" class="one-calendar-nav-time able show"></div>\n      <div id="oneCalendarYear" class="one-calendar-nav-time able"></div>\n      <div id="oneCalendarYearRange" class="one-calendar-nav-time"></div>\n      <div class="one-calendar-location">\n        <span id="oneCalendarSetToday" class="iconfont icon-dingwei" title="今天"></span>\n      </div>\n      <div class="one-calendar-nav-menu">\n        <span id="oneCalendarLast" class="iconfont icon-thin-up"></span>\n        <span id="oneCalendarNext" class="iconfont icon-thin-down"></span>\n      </div>\n    </div>\n    <div class="table-container">\n      <div id="oneCalendarAnimation" class="table-layer">\n        <table id="oneCalendarMain"></table>\n      </div>\n    </div>\n  ',document.querySelector("body").appendChild(N),[...y].forEach(n=>n.onclick=function(n){e(n.target)});var L=document.getElementById("oneCalendar"),b=document.getElementById("oneMoveCircle"),T=document.getElementById("oneCalendarLast"),B=document.getElementById("oneCalendarNext"),M=document.getElementById("oneCalendarClear"),k=document.getElementById("oneCalendarClose"),I=document.getElementById("oneCalendarMain"),x=document.getElementById("oneCalendarSetToday"),w=document.getElementById("oneCalendarAnimation"),A=document.getElementById("oneCalendarYear"),H=document.getElementById("oneCalendarYearRange"),$=document.getElementById("oneCalendarYearAndMonth");L.addEventListener("mousemove",function(e){var n=e,a=n.layerX,t=n.layerY;g===C&&(b.style="display: block;top:"+(t-40)+"px; left:"+(a-80)+"px")}),L.addEventListener("mouseleave",function(){b.setAttribute("style","display: none")}),L.addEventListener("click",function(e){var n=[],a="",t=e.target;"date-cell"===t.className?(n=document.getElementsByClassName("one-calendar-cell"),[...n].forEach(function(e){e.className=e.className.replace(/active/g,"")}),a=t.parentNode.getAttribute("class")+" active",t.parentNode.setAttribute("class",a)):"month-cell"===t.className?(p.month=parseFloat(t.innerHTML)-1,g=0,o(p)):"year-cell"===t.className&&(p.year=parseFloat(t.innerHTML),g=1,o(p))}),L.addEventListener("dblclick",function(e){var n=e.target,a=n.parentNode;if("date-cell"!==n.className)return!1;var t=p,l=t.year,o=t.month,d=n.innerText.padStart(2,"0");a.className.includes("last-month")&&(o>0?o--:l--&&(o=11)),a.className.includes("next-month")&&(11===o?l++&&(o=0):o++),E.value=l+"-"+(o+1).toString().padStart(2,"0")+"-"+d,L.style="display: none"}),T.addEventListener("click",function(){0===g?(p.month--,p.month<0&&(p.year--,p.month=11)):1===g?p.year--:p.year-=20,o(p)}),B.addEventListener("click",function(){0===g?(p.month++,p.month>11&&(p.year++,p.month=0)):1===g?p.year++:p.year+=20,o(p)}),k.addEventListener("click",function(){L.style.display="none"}),M.addEventListener("click",function(){E.value=""}),$.addEventListener("click",function(){g=1,p=s(),o(p)}),A.addEventListener("click",function(){g=2,p=s(),o(p)}),x.addEventListener("click",a)})();